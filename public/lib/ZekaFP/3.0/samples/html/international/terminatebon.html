<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="bg">
<link rel="stylesheet" type="text/css" href="main.css">
<script language="JavaScript" src="main.js"></script>
<title>Terminate Receipt</title>
<base target="_self">
</head>

<body>

<script language="javascript">
function work()
{
	result.innerText = "...";
	var zfp = new ActiveXObject("Zfpcom.ZekaFP");
	var res = zfp.Setup(parseInt(parent.frames.contents.comport.value, 10), parseInt(parent.frames.contents.baud.value, 10), 3, 1000);
	res = zfp.TerminateBon(finish.checked ? 0 : 1);

	result_color(zfp);
	result.innerText = zfp.GetErrorString(zfp.errorCode, 0);
}
</script>

<h1>Terminate Receipt</h1>
<br />
<p>This is a compound function. If there is open fiscal or non-fiscal receipt it will be closed.
The purpose of this function is to exit from unexpected errors while there is open receipt.</p>
<p>Cancel unpaid articles: <input type="checkbox" name="finish" value="0"><br />
  (The operation is not allowed if there is partial payment.)
</p>
<p>
<input type="button" value="Start" name="start" language="JavaScript" onclick="work();">
</p>
<p>
Result: <span id="result">None</span>
</p>


</body>

</html>