<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="bg">
<link rel="stylesheet" type="text/css" href="main.css">
<title>Описание на командите и параметр</title>
</head>

<body>

<h1>Описание на командите и техните параметри</h1>
<p>Входният файл съдържа команди в текстов 
(ASCII) вид. Всеки ред съдържа точно една команда. Форматът на командите е:</p>
<pre>[команда],[логически номер],[служебно поле];[параметри]</pre>
<p>[команда]: това поле съдържа една от следните букви: <b>S, T, C, P, I, Y, Z, D</b>
</p>
<p>[служебно поле]: съдържа 3 подполета, разделени с по една запетая. Всяко 
подполе се състои съответно от 6, 1 и 2 подчертавки: ______,_,__ В това поле 
ZFPCASH записва резултата от изпълнението на съответната команда. В първото 
6-разредно поле се записва фабричния номер на ФПР (при Zeka FP винаги е 123456). 
Във второто едноразредно поле се записва индекс от 0 до 9, който се увеличава с 
успешното изпълненение на всяка команда. Последното двуразредно поле съдържа 
информация за това дали и как е изпълнена командата във вида:&nbsp;&nbsp; __ - 
означава необработен запис ;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<h2>S - продажба на артикул:&nbsp;&nbsp; </h2>
<pre>S,[логически номер],_____,_,__;[артикул];[цена];[количество];[щанд];[стокова група];[данъчна група];0;0;</pre>
<ul>
	<li>[артикул] e името на артикула</li>
	<li>[цена] е единичната цена на артикула</li>
	<li>[количество] е закупеното количество</li>
	<li>[щанд] е номера на щанда – игнорира се при Zeka FP</li>
	<li>[стокова група] е номера на стоковата група – игнорира се при Zeka FP</li>
	<li>[данъчна група] e данъчната група на артикула </li>
</ul>
Zeka FP няма да изпълни тази команда, ако: 
<ul>
	<li>вече са направени 
	максималния брой продажби в един бон (999)</li>
	<li>сумата по някоя от данъчните 
	групи става отрицателна</li>
	<li>сумата от надбавки и отстъпки в рамките на бона 
	става отрицателна</li>
</ul>
<p>Във всеки от посочените случаи реултатът от изпълнението на командата ще бъде 
“Er”.</p>
<h2>T - край на бон или плащане:</h2>
<ul>
	<li>край на бон:<pre>Т,[логически номер],______,_,__;</pre>Извършва се плащане в брой на цялата сума наведнъж и затваряне на фискалния 
	бон.<br>
&nbsp;</li>
	<li>плащане:<pre>Т,[логически номер],______,_,__;[код];[сума];;;;</pre>&nbsp;<ul>
	<li>[код] е кода на плащане: 0,1,2,3, или 4; от 0 до 3 съответстват на плащане в брой, на кредит, с чек, купон с 4 се изчислява субтотал;</li>
	<li>[сума] е сумата, която се плаща</li>
	</ul>
	<br>
	Извършва се плащане с посочената сума и тип и ако се 
натрупа платена сума по-голяма от сумата за плащане, се извършва затваряне на 
бона. Докато това не стане, може да се изпълнява само тази команда и командата 
за печатане на текст. Командата се извиква с код 4, когато трябва да се извърши 
процентна надбавка/отстъпка върху натрупаната до момента сума.</li>
</ul>
<h2>C - процентна надбавка/отстъпка:</h2>
<pre>C,[логически номер],______,_,__;[тип];[процент];;;;</pre>
<ul>
	<li>[тип] - едно число със 
стойност 0 (надбавка) или 1 (отстъпка)</li>
	<li>[процент] - стойността на 
надбавката/отстъпката в процент (от 0 до 99.99);&nbsp;</li>
</ul>
<p>Ако преди тази 
команда се извърши плащане с параметър 4, ще се изпълни надбавка/отстъпка върху 
субтотала, в противен случай се извършва процентна надбавка/отстъпка върху 
сумата на последната продажба. За ФПР тази команда не може да бъде изпълнена 
повече от веднъж върху една и съща продажба или субтотал. В този случай 
програмата ще извърши само първата отстъпка/надбавка и ще спре при срещане на 
невалидната команда C.</p>
<h2>P - отпечатване на текст:</h2>
<pre>P,[логически номер],______,_,__;[ред 1];[ред 2];[ред 3];[ред 4];[ред 5];</pre>
<p>Ако редът е празен, той не се отпечатва. Ако съдържа само интервали, се печата 
като празен ред.&nbsp;&nbsp;&nbsp;&nbsp; </p>
<h2>I - служебно въвеждане и извеждане на суми:</h2>
<pre>I,[логически номер],______,_,__;[тип];[сума];;;;</pre>
<ul>
	<li>[тип] e 1 число със стойност 0 (въвеждане) или 1 (извеждане)</li>
	<li>[сума] е сумата, 
която ще се въвежда/извежда;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
</ul>
<h2>Y - начало на 
служебен бон:</h2>
<pre>Y,[логически номер],______,_,__;[ред 1];[ред 2];[ред 3];[ред 4];[ред 5];</pre>
<p>Отваря се служебен бон и се отпечатва само първия ред. В служебния бон може 
да се изпълнява само команда P (за отпечатване на текст) и команда T (за 
затваряне на служебния бон).</p>
<h2>Z 
- дневен финансов отчет:&nbsp;&nbsp; </h2>
<pre>Z,[логически номер],______,_,__; Извършва дневен финансов отчет с нулиране.</pre>
<h2>D - дубликат на бон :</h2>
<pre>D,[логически номер],______,_,__;</pre>
<p>Забележка: Aко 
служебното поле на ред от входния файл е различно от ______,_,__ реда не се 
обработва. Т.е. ако входния и изходния файл съвпадат при следващо стартиване с 
обработен файл нито един ред няма да се обработи.&nbsp;&nbsp; </p>
<p><i>Пример:</i></p>
<pre>S,1,______,_,__;Моркови;0.05;1.000;1;1;2;0;0;
S,1,______,_,__;Лук;0.05;1.000;1;1;2;0;0;
S,1,______,_,__;Картофи;0.02;1.000;1;1;2;0;0;
S,1,______,_,__;Домати;0.05;3.000;1;1;2;0;0;
T,1,______,_,__;4;;;;;
C,1,______,_,__;1;10.00;;;;
P,1,______,_,__; ;;;;;
P,1,______,_,__;Фискален принтер Zeka FP;;;;;
P,1,______,_,__; ;;;;;
T,1,______,_,__;
Y,1,______,_,__;   Служебен бон;;;;;
P,1,______,_,__;В служебния бон;;;;;
P,1,______,_,__;може да се изпълнява;;;;;
P,1,______,_,__;команда P;;;;;
P,1,______,_,__;за отпечатване на текст и;;;;;
P,1,______,_,__;команда T;за затваряне на служебния бон.; ;;;
T,1,______,_,__;</pre>

</body>

</html>