<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="stylesheet" type="text/css" href="../main.css">
<script language="JavaScript" src="../main.js"></script>
<title>Class CZekaFP members</title>
</head>

<body>

<p class="msghead">

<p><b>Setup / Error handling</b></p>

<script language="JavaScript">mf_text("Setup", "Setup");</script>&nbsp;-&nbsp; Setup 
the interface or change the current setup of a working interface
<br>
<div id="Setup" class="msgbody">
<pre>
HRESULT Setup([in] WORD wCom, [in] DWORD baud, [in] WORD retries, [in] DWORD retryWait);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	wCom
	<dd>
		Select the Serial COM port number to use (1 = COM1)
	</dd></dt>
	<dt>
	baud
	<dd>
		Select COM port baud rate. Supported baud rates: 9600 and 19200 bps
	</dd></dt>
	<dt>
	retries 
	<dd>
		How many retries the functions to make before giving up and reporting 
		the BUSY error
	</dd></dt>
	<dt>
	retryWait 
	<dd>
		How long the functions should wait between each retry (in miliseconds)
	</dd></dt>
</dl>
<br>
</div>

<script language="JavaScript">mf_text("Setup2", "Setup2");</script>&nbsp;-&nbsp; Setup 
the interface or change the current setup of a working interface
<br>
<div id="Setup2" class="msgbody">
<pre>
HRESULT Setup2([in] BYTE wCom, [in] long baud, [in] long retries, [in] long retryWait);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	wCom
	<dd>
		Select the Serial COM port number to use (1 = COM1)
	</dd></dt>
	<dt>
	baud
	<dd>
		Select COM port baud rate. Supported baud rates: 9600 and 19200 bps
	</dd></dt>
	<dt>
	retries 
	<dd>
		How many retries the functions to make before giving up and reporting 
		the BUSY error
	</dd></dt>
	<dt>
	retryWait 
	<dd>
		How long the functions should wait between each retry (in miliseconds)
	</dd></dt>
</dl>
<h3>Remarks:</h3>
<p>This command does the same as Setup command but has different parameter type. It could be used 
in VBA applications</p>
<br>
</div>

<script language="JavaScript">mf_text("BusyWait", "BusyWait");</script>&nbsp;-&nbsp; 
Wait for the fiscal printer to become ready after any report command
<br>
<div id="BusyWait" class="msgbody">
<pre>
int BusyWait(DWORD timeout);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	timeout
	<dd>
		Maximum wait time in miliseconds or ZFP_INFINITE (0xFFFFFFFF) to wait forever
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_NOFPRINTER if there is no fiscal printer connected<br>
ZFPE_FPBUSYTIMEOUT if the timeout has passed ZFPE_SUCCESS if the fiscal printer 
is ready
</p>
<h3>Remarks:</h3>
<p>This command could be used to wait for the fiscal printer to finish its 
current task. To setup every report command to wait automatically use 
SetAutoBusyWait with timeout value different than ZFP_NOBUSYWAIT. It is possible 
for the command to return error before the timeout passed if the printer 
connection has been lost meanwhile. This way if you wish to wait as long as needed but
the printer gets disconnected your program won't hang. Use this function carefully because
this is a blocking call.</p>
<br>
</div>

<script language="JavaScript">mf_text("SetAutoBusyWait", "SetAutoBusyWait");</script>
&nbsp;-&nbsp; Set / stop automatic fiscal printer wait after any report command.
<br>
<div id="SetAutoBusyWait" class="msgbody">
<pre>
void SetAutoBusyWait(DWORD timeout);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	timeout
	<dd>
		Maximum wait time in miliseconds or ZFP_INFINITE (0xFFFFFFFF) for infinite waiting or ZFP_NOBUSYWAIT (0) to stop the automatic waiting.
	</dd></dt>
</dl>
<h3>Remarks:</h3>
<p>This command setup whether the library to call BusyWait(timeout) after each report command, but only if the command
completed succesfully. In such case the report command result is the same as BusyWait(timeout) result. There is no such
waiting by default.<br>
<br>
Why do we need this waiting?<br>
When you send correct report command the fiscal printer return you "success" and start the report. 
The report lenght is not known in advance because it depends on the quiantity of the stored data.
It is possible to get ZFPE_FPRINTERBUSY (fisca printer is busy) error if you send any command meanwhile.
If you set SetAutoBusyWait(ZFP_INFINITE) durring the setup the report function will return only when the
fiscal printer is ready for the next command.</p>
<br>
</div>

<script language="JavaScript">mf_text("FindFirstFPCOM", "FindFirstFPCOM");</script>
&nbsp;-&nbsp;Search for Zeka fiscal printer on all COM ports and return the first COM port 
number with Zeka Fiscal Printer connected
<br>
<div id="FindFirstFPCOM" class="msgbody">
<pre>
HRESULT FindFirstFPCOM([out, retval] DWORD *pRes);
</pre>
<h3>Return Value:</h3>
<p>On success the lower 16 bits contain the COM port number the higher 16 bit contain the baud rate (9600 or 19200), the result is zero if no fiscal printer is found</p>
<br>
</div>

<script language="JavaScript">mf_text("GetErrorString", "GetErrorString");</script>
&nbsp;-&nbsp; Return text description of an error code
<br>
<div id="GetErrorString" class="msgbody">
<pre>
HRESULT GetErrorString([in] int error, [in] int lang, [out, retval] BSTR *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	error
	<dd>
		error code
	</dd></dt>
	<dt>
	lang
	<dd>
		Language identifier describing the requested description language (0 = 
		English, 1 = Bulgarian)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>BSTR which contains an error description</p>
<br>
</div>

<p><b>Properties</b></p>
<p>
<font color="#4169E1">errorCode</font> - The error code for the last called IZekaFP method
<i>(read only)</i><br>

<font color="#4169E1">zfplibVersion</font> - Version of this software library. The lowest 3 bytes are used.
If the result is 0x010203, the version is 1.2.3 -> 1 (0x01) . 2 (0x02) . 3 (0x03)
<i>(read only)</i><br>

<font color="#4169E1">errorCode</font> - The error code for the last called IZekaFP method
<i>(read only)</i><br>

<font color="#4169E1">zfpType</font> - Fiscal Printer type(ZFPT_BG = 0 for Bulgaria or ZFPT_RO = 1 for Romania)</p>

<p><b>Buffers</b></p>

<script language="JavaScript">mf_text("GetInputBuffer", "GetInputBuffer");</script>
&nbsp;-&nbsp;Return the input buffer and its length
<br>
<div id="GetInputBuffer" class="msgbody">
<pre>
HRESULT GetInputBuffer([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR which contains the input buffer</p>
<h3>Remarks:</h3>
<p>This is the exact buffer send to the Zeka Fiscal Printer durring the last 
command function call. It can be used for better undersanding and learning the 
communication protocol and for debugging. You don't need to call this function for normal 
daily operations. The function returns BSTR which might be empty or contain bytes with 0 as value</p>
<br>
</div>

<script language="JavaScript">mf_text("GetResponseBuffer", "GetResponseBuffer");</script>
&nbsp;-&nbsp;Return the response buffer and its length
<br>
<div id="GetResponseBuffer" class="msgbody">
<pre>
HRESULT GetResponseBuffer([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR which contains the response buffer</p>
<h3>Remarks:</h3>
<p>This is the exact buffer send from the Zeka Fiscal Printer durring the last 
command function call. It can be used for better undersanding and learning the 
protocol and for debugging. You don't need to call this function for normal 
daily operations. The function returns BSTR which might be empty or contain bytes with 0 as value
</p>
<br>
</div>

<script language="JavaScript">mf_text("GetInputHexFormated", "GetInputHexFormated");</script>
&nbsp;-&nbsp;Get the input buffer as a zero terminated string containing formated 
hexadecimal values
<br>
<div id="GetInputHexFormated" class="msgbody">
<pre>
HRESULT GetInputHexFormated([out, retval] BSTR *pRes)
</pre>
<h3>Return Value:</h3>
<p>BSTR which contains the input buffer formated as HEX data with 16 bytes per line</p>
<h3>Remarks:</h3>
<p>This is the exact buffer send to the Zeka Fiscal Printer durring the last 
command function call. It can be used for better undersanding and learning the 
protocol and for debugging. You don't need to call this function for normal 
daily operations.
</p>
<br>
</div>

<script language="JavaScript">mf_text("GetResponseHexFormated", "GetResponseHexFormated");</script>
&nbsp;-&nbsp;Get the response buffer as a zero terminated string containing formated 
hexadecimal values
<br>
<div id="GetResponseHexFormated" class="msgbody">
<pre>
HRESULT GetResponseHexFormated([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR which contains the response buffer formated as HEX data with 16 bytes per line</p>
<h3>Remarks:</h3>
<p>This is the exact buffer send from the Zeka Fiscal Printer durring the last 
command function call. It can be used for better undersanding and learning the 
protocol and for debugging. You don't need to call this function for normal 
daily operations.
</p>
<br>
</div>

<p><b>Commands</b></p>

<script language="JavaScript">mf_text("GetStatus", "GetStatus");</script>
&nbsp;-&nbsp;Get Fiscal Printer status information
<br>
<div id="GetStatus" class="msgbody">
<pre>
HRESULT GetStatus([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IZFPStatus_en.html">IZFPStatus</a> interface containing the Fiscal Printer status information</p>
<br>
</div>

<script language="JavaScript">mf_text("GetVersion", "GetVersion");</script>
&nbsp;-&nbsp;Get Fiscal Printer version information
<br>
<div id="GetVersion" class="msgbody">
<pre>
HRESULT GetVersion([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR which contains the version information</p>
<br>
</div>

<script language="JavaScript">mf_text("Diagnostic", "Diagnostic");</script>
&nbsp;-&nbsp;Print diagnosting information
<br>
<div id="Diagnostic" class="msgbody">
<pre>
HRESULT Diagnostic([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("DisplayClear", "DisplayClear");</script>
&nbsp;-&nbsp;Clear the external display
<br>
<div id="DisplayClear" class="msgbody">
<pre>
HRESULT DisplayClear([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("DisplayLine1", "DisplayLine1");</script>
&nbsp;-&nbsp;Display text on the first line of the display
<br>
<div id="DisplayLine1" class="msgbody">
<pre>
HRESULT DisplayLine1([in] BSTR line, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	line
	<dd>
		String containing the text to display. 
		If the text is bigger than 20 characters, it is truncated
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("DisplayLine2", "DisplayLine2");</script>
&nbsp;-&nbsp;Display text on the second line of the display
<br>
<div id="DisplayLine2" class="msgbody">
<pre>
HRESULT DisplayLine2([in] BSTR line, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	line
	<dd>
		String containing the text to display. 
		If the text is bigger than 20 characters, it is truncated
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("Display", "Display");</script>
&nbsp;-&nbsp;Display text on the both lines of the display
<br>
<div id="Display" class="msgbody">
<pre>
HRESULT Display([in] BSTR line, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	line
	<dd>
		String containing the text to display on the whole screen. 
		If the text is bigger than 40 characters, it is truncated
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("DisplayDateTime", "DisplayDateTime");</script>
&nbsp;-&nbsp;Display current date and time on the external display
<br>
<div id="DisplayDateTime" class="msgbody">
<pre>
HRESULT DisplayDateTime([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("OpenTill", "OpenTill");</script>
&nbsp;-&nbsp;Open the till
<br>
<div id="OpenTill" class="msgbody">
<pre>
HRESULT OpenTill([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("PaperCut", "PaperCut");</script>
&nbsp;-&nbsp;Print an empty line
<br>
<div id="PaperCut" class="msgbody">
<pre>
HRESULT PaperCut([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("LineFeed", "LineFeed");</script>
&nbsp;-&nbsp;Print an empty line
<br>
<div id="LineFeed" class="msgbody">
<pre>
HRESULT LineFeed([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<br>

<script language="JavaScript">mf_text("GetFactoryNumber", "GetFactoryNumber");</script>
&nbsp;-&nbsp;Get the factory number
<br>
<div id="GetFactoryNumber" class="msgbody">
<pre>
HRESULT GetFactoryNumber([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR containing the factory number</p>
<br>
</div>

<script language="JavaScript">mf_text("GetFiscalNumber", "GetFiscalNumber");</script>
&nbsp;-&nbsp;Get the fiscal number
<br>
<div id="GetFiscalNumber" class="msgbody">
<pre>
HRESULT GetFiscalNumber([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR containing the fiscal number</p>
<br>
</div>

<script language="JavaScript">mf_text("GetTaxNumber", "GetTaxNumber");</script>
&nbsp;-&nbsp;Get the Fiscal Printer tax number
<br>
<div id="GetTaxNumber" class="msgbody">
<pre>
HRESULT GetTaxNumber([out, retval] BSTR *pRes);
</pre>
<h3>Return Value:</h3>
<p>BSTR containing the tax number</p>
<br>
</div>

<script language="JavaScript">mf_text("GetTaxPercents", "GetTaxPercents");</script>
&nbsp;-&nbsp;Get the Fiscal Printer tax percents for different tax groups
<br>
<div id="GetTaxPercents" class="msgbody">
<pre>
HRESULT GetTaxPercents([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="ITaxNumbers_en.html">ITaxNumbers</a> interface containing the tax percents for different tax groups</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDecimalPoint", "GetDecimalPoint");</script>
&nbsp;-&nbsp;Get the decimal point position
<br>
<div id="GetDecimalPoint" class="msgbody">
<pre>
HRESULT GetDecimalPoint([out, retval] long *pPoint);
</pre>
<h3>Return Value:</h3>
<p>The decimal point position</p>
<br>
</div>

<script language="JavaScript">mf_text("GetPayTypes", "GetPayTypes");</script>
&nbsp;-&nbsp;Get pay type names as strings
<br>
<div id="GetPayTypes" class="msgbody">
<pre>
HRESULT GetPayTypes([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing the names of all pay types. 
The following properties are filled: paytype0 to paytype4</p>
<br>
</div>

<script language="JavaScript">mf_text("GetParameters", "GetParameters");</script>
&nbsp;-&nbsp;Get different Fiscal Printer parameters
<br>
<div id="GetParameters" class="msgbody">
<pre>
HRESULT GetParameters([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IZFPParameters_en.html">IZFPParameters</a> interface containing different Fiscal Printer parameters</p>
<br>
</div>

<script language="JavaScript">mf_text("GetEJMode", "GetEJMode");</script>
&nbsp;-&nbsp;Get electronic journal (EJ) print mode
<br>
<div id="GetEJMode" class="msgbody">
<pre>
HRESULT GetEJMode([out, retval] long *pIsShort);
</pre>
<h3>Return Value:</h3>
<p>Electronic journal (EJ) print mode</p>
<br>
</div>

<script language="JavaScript">mf_text("GetFreeFiscalSpace", "GetFreeFiscalSpace");</script>
&nbsp;-&nbsp;Get the count of free fiscal records
<br>
<div id="GetFreeFiscalSpace" class="msgbody">
<pre>
HRESULT GetFreeFiscalSpace([out, retval] long *pRecords);
</pre>
<h3>Return Value:</h3>
<p>Òhe count of free fiscal records</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDateTime", "GetDateTime");</script>
&nbsp;-&nbsp;Get the current date and time
<br>
<div id="GetDateTime" class="msgbody">
<pre>
HRESULT GetDateTime([out, retval] DATE* pVal);
</pre>
<h3>Return Value:</h3>
<p>Fiscal Printer's data and time as a DATE type</p>
<br>
</div>

<script language="JavaScript">mf_text("GetClicheLine", "GetClicheLine");</script>
&nbsp;-&nbsp;Get cliche line text by given line number
<br>
<div id="GetClicheLine" class="msgbody">
<pre>
HRESULT GetClicheLine([in]BYTE num, [out, retval] BSTR *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	lineNum
	<dd>
		Specify the line to read text from. Line numbers are from 1 to 8
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>BSTR containing the cliche line text by given line number</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDepartment", "GetDepartment");</script>
&nbsp;-&nbsp;Get informaton about a department
<br>
<div id="GetDepartment" class="msgbody">
<pre>
HRESULT GetDepartment([in] WORD number, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	number
	<dd>
		Department number
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IArticleInfo_en.html">IArticleInfo</a> interface containing 
information about selected department</p>
<br>
</div>

<script language="JavaScript">mf_text("GetOperatorUserPass", "GetOperatorUserPass");</script>
&nbsp;-&nbsp;Get operator user name and password by given operator number
<br>
<div id="GetOperatorUserPass" class="msgbody">
<pre>
HRESULT GetOperatorUserPass([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IOperatorInfo_en.html">IOperatorInfo</a> interface containing different Fiscal Printer parameters</p>
<br>
</div>

<script language="JavaScript">mf_text("PrintLogo", "PrintLogo");</script>
&nbsp;-&nbsp;Print the logo
<br>
<div id="PrintLogo" class="msgbody">
<pre>
HRESULT PrintLogo([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<br>

<script language="JavaScript">mf_text("OpenBon", "OpenBon");</script>
&nbsp;-&nbsp;Open non fiscal receipt
<br>
<div id="OpenBon" class="msgbody">
<pre>
HRESULT OpenBon([in]BYTE oper, [in] BSTR passwd, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
	<dt>
	passwd
	<dd>
		String containing operator password. This string is cut to the first 4 characters
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("OpenBonWithEJ", "OpenBonWithEJ");</script>
&nbsp;-&nbsp;Open non fiscal receipt with an option to record it in the EJ
<br>
<div id="OpenBonWithEJ" class="msgbody">
<pre>
HRESULT OpenBonWithEJ([in]BYTE oper, [in] BSTR passwd, [in] BOOL hasEJ, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
	<dt>
	passwd
	<dd>
		String containing operator password. This string is cut to the first 4 characters
	</dd></dt>
	<dt>
	hasEJ
	<dd>
		boolean value 1 for record in EJ or 0 for no EJ record 
		(Zeka FP03 and newer only, ignored in older models).
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("CloseBon", "CloseBon");</script>
&nbsp;-&nbsp;Close a receipt previously opened with OpenBon()
<br>
<div id="CloseBon" class="msgbody">
<pre>
HRESULT CloseBon([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("OpenFiscalBon", "OpenFiscalBon");</script>
&nbsp;-&nbsp;Open fiscal receipt 
<br>
<div id="OpenFiscalBon" class="msgbody">
<pre>
HRESULT OpenFiscalBon([in] BYTE oper, [in] BSTR passwd, [in] BYTE detailed, [in] BYTE printVat, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
	<dt>
	passwd
	<dd>
		String containing operator password. This string is cut to the first 4 characters
	</dd></dt>
	<dt>
	detailed
	<dd>
		flag for detailed output (use 0 = do not print, 1 = print)
	</dd></dt>
	<dt>
	dds
	<dd>
		flag for printing the DDS tax sum (use 0 = do not print, 1 = print)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("OpenInvoice", "OpenInvoice");</script>
&nbsp;-&nbsp;Open fiscal receipt - invoice
<br>
<div id="OpenInvoice" class="msgbody">
<pre>
HRESULT OpenInvoice([in] BYTE oper, [in] BSTR passwd, [in] BSTR client, [in] BSTR receiver, 
                    [in] BSTR vatNum, [in] BSTR identNum, [in] BSTR address, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
	<dt>
	passwd
	<dd>
		String containing operator password. This string is cut to the first 4 characters
	</dd></dt>
	<dt>
	client
	<dd>
		String containing client's name. This string is cut to the first 26 characters
	</dd></dt>
	<dt>
	receiver
	<dd>
		String containing receiver's name. This string is cut to the first 16 characters
	</dd></dt>
	<dt>
	vatNum
	<dd>
		String containing client's VAT number. This string is cut to the first 13 characters
	</dd></dt>
	<dt>
	identNum
	<dd>
		String containing client's Identification number. This string is cut to the first 13 characters
	</dd></dt>
	<dt>
	address
	<dd>
		String containing client's address. This string is cut to the first 30 characters
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SellFree", "SellFree");</script>
&nbsp;-&nbsp;Sells an article
<br>
<div id="SellFree" class="msgbody">
<pre>
HRESULT SellFree([in] BSTR name, [in] BYTE taxgrp, [in] double price, [in] double quantity, [in] double discount, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	name
	<dd>
		String containing article name. This string is cut to the first 36 characters
	</dd></dt>
	<dt>
	taxgrp
	<dd>
		Specify the tax group. Should be '&#1040;', '&#1041;' or '&#1042;' in Bulgarian Cyrillic alphabet, or some of these values 0, 1, 2, '0', '1', '2'.
	</dd></dt>
	<dt>
	price
	<dd>
		Specify the price.
	</dd></dt>
	<dt>
	quantity 
	<dd>
		Specify the quantity.
	</dd></dt>
	<dt>
	discount
	<dd>
		Specify the discount/addition in percents.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SellDepartment", "SellDepartment");</script>
&nbsp;-&nbsp;Sell from department
<br>
<div id="SellDepartment" class="msgbody">
<pre>
HRESULT SellDepartment([in] BSTR name, [in] WORD depNum, [in] double price, [in] double quantity, [in] double discount, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	name
	<dd>
		A buffer containing zero terminated article name. This buffer is cut to 
		the first 36 characters.
	</dd></dt>
	<dt>
	depNum
	<dd>
		Department number.
	</dd></dt>
	<dt>
	price
	<dd>
		Specify the price.
	</dd></dt>
	<dt>
	quantity 
	<dd>
		Specify the quantity.
	</dd></dt>
	<dt>
	discount
	<dd>
		Specify the discount/addition in percents.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SellDB", "SellDB");</script>
&nbsp;-&nbsp;Sells an article from the Fiscal Printer internal database
<br>
<div id="SellDB" class="msgbody">
<pre>
HRESULT SellDB([in] BOOL isVoid, [in] WORD number, [in] double quantity, [in] double discount, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	isVoid
	<dd>
		flag specifying is this a void operation or a sell
	</dd></dt>
	<dt>
	number
	<dd>
		Specify the article database number from 1 to 1024.
	</dd></dt>
	<dt>
	quantity 
	<dd>
		Specify the quantity.
	</dd></dt>
	<dt>
	discount
	<dd>
		Specify the discount/addition in percents.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("CalcIntermediateSum", "CalcIntermediateSum");</script>
&nbsp;-&nbsp;Calculate the intermediate sum
<br>
<div id="CalcIntermediateSum" class="msgbody">
<pre>
HRESULT CalcIntermediateSum([in] BOOL doprint, [in] BOOL dodisplay, [in] BOOL dopercents, [in] double discount, [out, retval] double *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	doprint
	<dd>
		flags specifying do we need to print the intermediate sum (1 = yes)
	</dd></dt>
	<dt>
	doprint
	<dd>
		flags specifying do we need to show the intermediate sum on the display (1 = yes)
	</dd></dt>
	<dt>
	dopercents
	<dd>
		flags specifying that the discount/addition is in percents (1 = yes)
	</dd></dt>
	<dt>
	sum
	<dd>
		Receive the intermediate sum.
	</dd></dt>
	<dt>
	discount
	<dd>
		Specify the discount/addition as a sum or in percents (depends on dopercents flag).
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>The intermediate sum</p>
<br>
</div>

<script language="JavaScript">mf_text("CalcIntermediateSum2", "CalcIntermediateSum2");</script>
&nbsp;-&nbsp;Calculate the intermediate sum
<br>
<div id="CalcIntermediateSum" class="msgbody">
<pre>
HRESULT CalcIntermediateSum2([in] BOOL doprint, [in] BOOL dodisplay, [in] BOOL dopercents, [in] double discount, [in] BYTE taxgrp, [out, retval] double *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	doprint
	<dd>
		flags specifying do we need to print the intermediate sum (1 = yes)
	</dd></dt>
	<dt>
	doprint
	<dd>
		flags specifying do we need to show the intermediate sum on the display (1 = yes)
	</dd></dt>
	<dt>
	dopercents
	<dd>
		flags specifying that the discount/addition is in percents (1 = yes)
	</dd></dt>
	<dt>
	sum
	<dd>
		Receive the intermediate sum.
	</dd></dt>
	<dt>
	discount
	<dd>
		Specify the discount/addition as a sum or in percents (depends on dopercents flag).
	</dd></dt>
	<dt>
	taxgrp 
	<dd>
		Specify the tax group (ignored in bulgarian version of Zeka FP).
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>The intermediate sum</p>
<br>
</div>

<script language="JavaScript">mf_text("Payment", "Payment");</script>
&nbsp;-&nbsp;Register a payment
<br>
<div id="Payment" class="msgbody">
<pre>
HRESULT Payment([in] double sum, [in] BYTE type, [in] BOOL noRest, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	sum
	<dd>
		Specify the sum to be paid
	</dd></dt>
	<dt>
	type
	<dd>
		Specify the payment type number (0, 1, 2 or 3)
	</dd></dt>
	<dt>
	noRest
	<dd>
		Specify that payment doesn't require a change (affective only with 
		certain payment types)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("PrintText", "PrintText");</script>
&nbsp;-&nbsp;Print a text
<br>
<div id="PrintText" class="msgbody">
<pre>
HRESULT PrintText([in] BSTR text, [in] int align, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	text
	<dd>
		String containing zero terminated text to be printed. This string is cut to the first 34 characters
	</dd></dt>
	<dt>
	align
	<dd>
		Text alignment mode (0 = left alignment, 1 = right alignment, 2 = center text)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<h3>Remarks:</h3>
<p>The free text can be used to print any text not only inside a receipt</p>
<br>
</div>

<script language="JavaScript">mf_text("GetCurrentBonInfo", "GetCurrentBonInfo");</script>
&nbsp;-&nbsp;Get information about the current open fiscal receipt
<br>
<div id="GetCurrentBonInfo" class="msgbody">
<pre>
HRESULT GetCurrentBonInfo([out, retval] LPDISPATCH *pVal);
</pre>
<h3>Return Value:</h3>
<p><a href="IGetCurrentBonInfoRes_en.html">IGetCurrentBonInfoRes</a> interface containing information 
about the currently opened fiscal receipt</p>
<h3>Remarks:</h3>
<p>On succesful call you need to check the value of the flags property of the IGetCurrentBonInfoRes interface. 
If this flag is 0 no other information is valid and we do not have an open receipt</p>
<br>
</div>

<script language="JavaScript">mf_text("CloseFiscalBon", "CloseFiscalBon");</script>
&nbsp;-&nbsp;Close previously opened fiscal receipt
<br>
<div id="CloseFiscalBon" class="msgbody">
<pre>
HRESULT CloseFiscalBon([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("PrintDuplicate", "PrintDuplicate");</script>
&nbsp;-&nbsp;Print a duplicate of the last receipt
<br>
<div id="PrintDuplicate" class="msgbody">
<pre>
HRESULT PrintDuplicate([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("GetBonNumber", "GetBonNumber");</script>
&nbsp;-&nbsp;Get the number of the last printed receipt
<br>
<div id="GetBonNumber" class="msgbody">
<pre>
HRESULT GetBonNumber([out, retval] long *pNumber);
</pre>
<h3>Return Value:</h3>
<p>The number of the last printed receipt</p>
<br>
</div>

<br>

<script language="JavaScript">mf_text("OfficialSums", "OfficialSums");</script>
&nbsp;-&nbsp;Register an official sum addition or withdraw
<br>
<div id="OfficialSums" class="msgbody">
<pre>
HRESULT OfficialSums([in]BYTE num, [in] BSTR passwd, [in] BYTE type, [in] double sum, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
	<dt>
	passwd
	<dd>
		String containing operator password. This string is cut to the first 4 characters
	</dd></dt>
	<dt>
	type
	<dd>
		Specify the payment type number (0, 1, 2 or 3)
	</dd></dt>
	<dt>
	sum
	<dd>
		Specify the sum
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("GetArticleInfo", "GetArticleInfo");</script>
&nbsp;-&nbsp;Receive information about selected article from the internal Fiscal Printer database
<br>
<div id="GetArticleInfo" class="msgbody">
<pre>
HRESULT GetArticleInfo([in] WORD number, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	number
	<dd>
		Specify the article database number from 1 to 1024.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IArticleInfo_en.html">IArticleInfo</a> interface containing 
information about selected article from the internal Fiscal Printer database</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailySums", "GetDailySums");</script>
&nbsp;-&nbsp;Get daily sums for different tax groups
<br>
<div id="GetDailySums" class="msgbody">
<pre>
HRESULT GetDailySums([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="ITaxNumbers_en.html">ITaxNumbers</a> interface containing the daily sums for different tax groups</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyInfo", "GetDailyInfo");</script>
&nbsp;-&nbsp;Get daily info
<br>
<div id="GetDailyInfo" class="msgbody">
<pre>
HRESULT GetDailyInfo([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IDailySums_en.html">IDailySums</a> interface containing information about the daily sums</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyPayments", "GetDailyPayments");</script>
&nbsp;-&nbsp;Get daily sums for different pay types
<br>
<div id="GetDailyPayments" class="msgbody">
<pre>
HRESULT GetDailyPayments([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily sums for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyIncomes", "GetDailyIncomes");</script>
&nbsp;-&nbsp;Get daily income sums for different pay types
<br>
<div id="GetDailyIncomes" class="msgbody">
<pre>
HRESULT GetDailyIncomes([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily income sums for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyOfficialIncomes", "GetDailyOfficialIncomes");</script>
&nbsp;-&nbsp;Get daily official income sums for different pay types
<br>
<div id="GetDailyOfficialIncomes" class="msgbody">
<pre>
HRESULT GetDailyOfficialIncomes([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily official income sums for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum, operations</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyOfficialExpenses", "GetDailyOfficialExpenses");</script>
&nbsp;-&nbsp;Get daily official expense sums for different pay types
<br>
<div id="GetDailyOfficialExpenses" class="msgbody">
<pre>
HRESULT GetDailyOfficialExpenses([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily official expense sums 
for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum, operations</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyReport", "GetDailyReport");</script>
&nbsp;-&nbsp;Get report counter, last fiscal memory report number, electronic cash line number (if present), last report's date
<br>
<div id="GetDailyReport" class="msgbody">
<pre>
HRESULT GetDailyReport([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IDailyReport_en.html">IDailyReport</a> interface containing the report counter, 
last fiscal memory report number, electronic cash line number (if present), last report's date</p>
<br>
</div>

<script language="JavaScript">mf_text("GetLastFiscalReportData", "GetLastFiscalReportData");</script>
&nbsp;-&nbsp;The date and numbers of the last report
<br>
<div id="GetLastFiscalReportData" class="msgbody">
<pre>
HRESULT GetLastFiscalReportData([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IFiscalReportData_en.html">IFiscalReportData</a> interface containing the date and the number of
the last daily report and the number of the last zeroing if the RAM</p>
<br>
</div>

<br>

<script language="JavaScript">mf_text("GetOperatorInfo", "GetOperatorInfo");</script>
&nbsp;-&nbsp;Get daily info for an operator
<br>
<div id="GetOperatorInfo" class="msgbody">
<pre>
HRESULT GetOperatorInfo([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IDailySums_en.html">IDailySums</a> interface containing information about the daily sums for the operator</p>
<br>
</div>

<script language="JavaScript">mf_text("GetOperatorIncomes", "GetOperatorIncomes");</script>
&nbsp;-&nbsp;Get daily income sums per operator for different pay types
<br>
<div id="GetOperatorIncomes" class="msgbody">
<pre>
HRESULT GetOperatorIncomes([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily 
income sums per operator for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum, operations</p>
<br>
</div>

<script language="JavaScript">mf_text("GetOperatorExpenses", "GetOperatorExpenses");</script>
&nbsp;-&nbsp;Get daily expense sums per operator for different pay types
<br>
<div id="GetOperatorExpenses" class="msgbody">
<pre>
HRESULT GetOperatorExpenses([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily 
expense sums per operator for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum, operations</p>
<br>
</div>

<script language="JavaScript">mf_text("GetOperatorReceives", "GetOperatorReceives");</script>
&nbsp;-&nbsp;Get daily received sums per operator for different pay types
<br>
<div id="GetOperatorReceives" class="msgbody">
<pre>
HRESULT GetOperatorReceives([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily 
received sums per operator for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum</p>
<br>
</div>

<script language="JavaScript">mf_text("GetOperatorCounter", "GetOperatorCounter");</script>
&nbsp;-&nbsp;Get operator report counter and report date
<br>
<div id="GetOperatorCounter" class="msgbody">
<pre>
HRESULT GetOperatorCounter([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IDailyReport_en.html">IDailyReport</a> interface containing the roperator report counter 
and report date<br>
The following properties are filled: counter, datetime</p>
<br>
</div>

<p><b>Setup commands &amp; tools</b></p>

<script language="JavaScript">mf_text("SetPayType", "SetPayType");</script>
&nbsp;-&nbsp;Set pay type name text
<br>
<div id="SetPayType" class="msgbody">
<pre>
HRESULT SetPayType([in]BYTE type, [in] BSTR line, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	type
	<dd>
		Specify the payment type number (1, 2 or 3)
	</dd></dt>
	<dt>
	line
	<dd>
		String containing payment type name. This string is cut to the first 10 characters
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetParameters", "SetParameters");</script>
&nbsp;-&nbsp;Set different Fiscal Printer parameters
<br>
<div id="SetParameters" class="msgbody">
<pre>
HRESULT SetParameters([in] WORD fpnum, [in] BOOL logo, [in] BOOL till, [in] BOOL autocut, [in] BOOL transparent, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	fpNum
	<dd>
		Specify the Fiscal Printer place number
	</dd></dt>
	<dt>
	logo
	<dd>
		logo printing status (0 = not printed, otherwise printed)
	</dd></dt>
	<dt>
	till
	<dd>
		till status (0 = don't have a till, otherwise till is present)
	</dd></dt>
	<dt>
	autocut
	<dd>
		auto cutter status (0 = don't have one, otherwise present)
	</dd></dt>
	<dt>
	transparent
	<dd>
		transparent display status (0 = no display or not transparent, otherwise 
		transparent display)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetDateTime", "SetDateTime");</script>
&nbsp;-&nbsp;Set the current date and time of the Fiscal Printer
<br>
<div id="SetDateTime" class="msgbody">
<pre>
HRESULT SetDateTime([in] DATE datetime, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	datetime
	<dd>
		current date and time
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetClicheLine", "SetClicheLine");</script>
&nbsp;-&nbsp;Set cliche line text by given line number
<br>
<div id="SetClicheLine" class="msgbody">
<pre>
HRESULT SetClicheLine([in]BYTE num, [in] BSTR text, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	lineNum
	<dd>
		Specify the line to setup text. Line numbers are from 1 to 8
	</dd></dt>
	<dt>
	text
	<dd>
		String containing the clishe line text. This string is cut to the first 38 characters
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetOperatorUserPass", "SetOperatorUserPass");</script>
&nbsp;-&nbsp;Set operator user name and password by given operator number
<br>
<div id="SetOperatorUserPass" class="msgbody">
<pre>
HRESULT SetOperatorUserPass([in] BYTE oper, [in] BSTR name, [in] BSTR passwd, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
	<dt>
	name
	<dd>
		String with the operator name. This string is cut to the first 20 characters
	</dd></dt>
	<dt>
	passwd
	<dd>
		String with the operator password. This string is cut to the first 4 characters
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetArticleInfo", "SetArticleInfo");</script>
&nbsp;-&nbsp;Set information about selected article from the internal Fiscal Printer 
database
<br>
<div id="SetArticleInfo" class="msgbody">
<pre>
HRESULT SetArticleInfo([in] WORD num, [in] BSTR name, [in] double price, [in] BYTE taxgrp, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	number
	<dd>
		Specify the article database number from 1 to 1024.
	</dd></dt>
	<dt>
	name
	<dd>
		Article name. This string is cut to the first 20 characters
	</dd></dt>
	<dt>
	price
	<dd>
		price
	</dd></dt>
	<dt>
	taxgrp
	<dd>
		Specify the tax group. Should be '&#1040;', '&#1041;' or '&#1042;' in Bulgarian Cyrillic alphabet, or some of these values 0, 1, 2, '0', '1', '2'.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetArticleInfoEx", "SetArticleInfoEx");</script>
&nbsp;-&nbsp;Set information about selected article from the internal Fiscal Printer with department
database
<br>
<div id="SetArticleInfoEx" class="msgbody">
<pre>
HRESULT SetArticleInfoEx([in] WORD num, [in] BSTR name, [in] double price, [in] BYTE taxgrp, [in] WORD department, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	number
	<dd>
		Specify the article database number from 1 to 1024.
	</dd></dt>
	<dt>
	name
	<dd>
		Article name. This string is cut to the first 20 characters
	</dd></dt>
	<dt>
	price
	<dd>
		price
	</dd></dt>
	<dt>
	taxgrp
	<dd>
		Specify the tax group. Should be '&#1040;', '&#1041;' or '&#1042;' in Bulgarian Cyrillic alphabet, or some of these values 0, 1, 2, '0', '1', '2'.
	</dd></dt>
	<dt>
	department
	<dd>
		Department number
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetLogoFile", "SetLogoFile");</script>
&nbsp;-&nbsp;Setup logo from bitmap file
<br>
<div id="SetLogoFile" class="msgbody">
<pre>
HRESULT SetLogoFile([in] BSTR filename, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	filename
	<dd>
		File name.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<h3>Remarks:</h3>
<p>The logo needs to be bitmap (.BMP) file with 1 bpp and dimensions 384 x 80. 
The resulted file is 3902 bytes long</p>
<br>
</div>

<script language="JavaScript">mf_text("SetLocalDateTime", "SetLocalDateTime");</script>
&nbsp;-&nbsp;Setup Fiscal Printer date and time based on the local date and time of the computer
<br>
<div id="SetLocalDateTime" class="msgbody">
<pre>
HRESULT SetLocalDateTime([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetExternalDisplayFile", "SetExternalDisplayFile");</script>
&nbsp;-&nbsp;External display programming
<br>
<div id="SetExternalDisplayFile" class="msgbody">
<pre>
HRESULT SetExternalDisplayFile([in] BSTR password, [in] BSTR filename, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	password
	<dd>
		Zero terminated buffer containing the password. This buffer is cut to 
		the first 6 characters.
	</dd></dt>
	<dt>
	filename
	<dd>
		Zero terminated file name.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetDepartment", "SetDepartment");</script>
&nbsp;-&nbsp;Setup department
<br>
<div id="SetDepartment" class="msgbody">
<pre>
HRESULT SetDepartment([in] WORD number, [in] BSTR name, [in] BYTE taxgrp, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	number
	<dd>
		Department number.
	</dd></dt>
	<dt>
	name
	<dd>
		Department name. Name is cut to the first 20 characters.
	</dd></dt>
	<dt>
	taxgrp
	<dd>
		Specify the tax group. Should be 'À', 'Á' or 'Â' in Bulgarian Cyrillic 
		alphabet, or some of these values 0, 1, 2, '0', '1', '2'.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetEJMode", "SetEJMode");</script>
&nbsp;-&nbsp;Set electronic journal (EJ) print mode
<br>
<div id="SetEJMode" class="msgbody">
<pre>
HRESULT SetEJMode([in] BOOL bShort, [out, retval] long *pRes)
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	bShort
	<dd>
		Not zero (true) means short EJ, zero (false) means normal (EJ)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<p><b>Reports</b></p>

<script language="JavaScript">mf_text("ReportSpecialFiscal", "ReportSpecialFiscal");</script>
&nbsp;-&nbsp;Special fiscal report
<br>
<div id="ReportSpecialFiscal" class="msgbody">
<pre>
HRESULT ReportSpecialFiscal([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportFiscalByBlock", "ReportFiscalByBlock");</script>
&nbsp;-&nbsp;Fiscal report by block number
<br>
<div id="ReportFiscalByBlock" class="msgbody">
<pre>
HRESULT ReportFiscalByBlock([in] BOOL detailed, [in] WORD startNumber, [in] WORD endNumber, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	detailed
	<dd>
		Specify is the report detailed.
	</dd></dt>
	<dt>
	startNumber
	<dd>
		Report start number
	</dd></dt>
	<dt>
	endNumber
	<dd>
		Report end number
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportFiscalByDate", "ReportFiscalByDate");</script>
&nbsp;-&nbsp;Fiscal report by date
<br>
<div id="ReportFiscalByDate" class="msgbody">
<pre>
HRESULT ReportFiscalByDate([in] BOOL detailed, [in] DATE start, [in] DATE end, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	detailed
	<dd>
		Specify is the report detailed.
	</dd></dt>
	<dt>
	start
	<dd>
		Start day, month and year
	</dd></dt>
	<dt>
	end
	<dd>
		End day, month and year
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportDaily", "ReportDaily");</script>
&nbsp;-&nbsp;Daily report
<br>
<div id="ReportDaily" class="msgbody">
<pre>
HRESULT ReportDaily([in] BOOL zero, [in] BOOL extended, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	zero
	<dd>
		Specify will the report zero the daily sums.
	</dd></dt>
	<dt>
	extended
	<dd>
		Specify is the report extended.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportEJ", "ReportEJ");</script>
&nbsp;-&nbsp;Electronic Journal (EJ) report
<br>
<div id="ReportEJ" class="msgbody">
<pre>
HRESULT ReportEJ([out, retval] long *pRes);
</pre>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportEJ2", "ReportEJ2");</script>
&nbsp;-&nbsp;Electronic Journal (EJ) report
<br>
<div id="ReportEJ2" class="msgbody">
<pre>
HRESULT ReportEJ2([in] WORD num, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	num 
	<dd>
		Receipt number (not used in Bulgarian Zeka FP)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportOperator", "ReportOperator");</script>
&nbsp;-&nbsp;Operator report
<br>
<div id="ReportOperator" class="msgbody">
<pre>
HRESULT ReportOperator([in] BOOL zero, [in] BYTE oper, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	zero
	<dd>
		Specify will the report zero the daily sums.
	</dd></dt>
	<dt>
	oper
	<dd>
		Specify the operator number from 0 to 9 (0 = all).
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReportArticles", "ReportArticles");</script>
&nbsp;-&nbsp;Report by articles
<br>
<div id="ReportArticles" class="msgbody">
HRESULT ReportArticles([in] BOOL zero, [out, retval] long *pRes);
<pre>
int ReportArticles(BOOL zero);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	zero
	<dd>
		Specify will the report zero the daily sums.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("ReadFiscalMemory", "ReadFiscalMemory");</script>
&nbsp;-&nbsp;Read the fiscal memory into a file
<br>
<div id="ReadFiscalMemory" class="msgbody">
<pre>
HRESULT ReadFiscalMemory([in] BSTR filename, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	filename
	<dd>
		File name. If the file doesn't exits it is created. If 
		the file exists it will be overided. The file has the following format:<br/>
		<pre>
&lt;NBL&gt;&lt;CMD&gt;&lt;segment number&gt;;&lt;record code&gt;;&lt;record date&gt;;&lt;status&gt;;&lt;data&gt;
.
..
&lt;NBL&gt;&lt;CMD&gt;&lt;segment number&gt;;&lt;record code&gt;;&lt;record date&gt;;&lt;status&gt;;&lt;data&gt;


&lt;NBL&gt;&lt;CMD&gt;&lt;segment number&gt;;&lt;@&gt; - end of records


record code / record type
00 Factory record
01 Fiscalization
04 Daily report
05 Zero RAM
06 Tax percents
07 Decimal point
	</pre>
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<p><b>New functions in Zeka FP-E and Zeka FP01-E</b></p>
<p>
The functions below are added in version 2.0 of ZFPlib to support the new functionality of Zeka FP-E and Zeka FP01-E devices.
These functions can be used with the old Zeka FP è Zeka FP01 as well but the new parameters not supported by the old devices have 
specific values by default.
</p>

<script language="JavaScript">mf_text("PaymentEU", "PaymentEU");</script>
&nbsp;-&nbsp;Register a payment
<br>
<div id="PaymentEU" class="msgbody">
<pre>
HRESULT PaymentEU([in] double sum, [in] BYTE type, [in] BOOL noChange, [in] BYTE changeType, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	sum
	<dd>
		Specify the sum to be paid
	</dd></dt>
	<dt>
	type
	<dd>
		Specify the payment type number (0 to 4)
	</dd></dt>
	<dt>
	noChange
	<dd>
		Specify that payment doesn't require a change (affective only with 
		certain payment types)
	</dd></dt>
	<dt>
	changeType
	<dd>
		Change type. 0 = cash (payment type 0), 1 = change in specified payment type (default when used with Zeka FP and Zeka FP01), 2 = change in currency (payment type 4)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("GetOperatorChangeEU", "GetOperatorChangeEU");</script>
&nbsp;-&nbsp;Get daily change sums per operator for different pay types (new for Zeka FP-E and Zeka FP01-E)
<br>
<div id="GetOperatorChangeEU" class="msgbody">
<pre>
HRESULT GetOperatorChangeEU([in] BYTE oper, [out, retval] LPDISPATCH *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	oper
	<dd>
		Specify the operator number from 1 to 9.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily 
change sums per operator for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum, operations</p>
<br>
</div>

<script language="JavaScript">mf_text("GetDailyChangeEU", "GetDailyChangeEU");</script>
&nbsp;-&nbsp;Get daily sums returned as change for different tax groups (new for Zeka FP-E and Zeka FP01-E)
<br>
<div id="GetDailyChangeEU" class="msgbody">
<pre>
GetDailyChangeEU([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IPayTypes_en.html">IPayTypes</a> interface containing information about the daily 
change sums for different pay types<br>
The following properties are filled: paytype0sum to paytype4sum, operations</p>
<br>
</div>

<script language="JavaScript">mf_text("GetInvoiceNextNumberEU", "GetInvoiceNextNumberEU");</script>
&nbsp;-&nbsp;Get next and last invoice number according to the invoice number range setup (new for Zeka FP-E and Zeka FP01-E)
<br>
<div id="GetInvoiceNextNumberEU" class="msgbody">
<pre>
HRESULT GetInvoiceNextNumberEU([out, retval] LPDISPATCH *pRes);
</pre>
<h3>Return Value:</h3>
<p><a href="IInvoiceNumbers_en.html">IInvoiceNumbers</a> interface containing information about next and last invoice number
<br>
</div>

<script language="JavaScript">mf_text("SetInvoiceNumbersRangeEU", "SetInvoiceNumbersRangeEU");</script>
&nbsp;-&nbsp;Specifies invoice number range (new for Zeka FP-E and Zeka FP01-E)
<br>
<div id="SetInvoiceNumbersRangeEU" class="msgbody">
<pre>
HRESULT SetInvoiceNumbersRangeEU([in] BSTR startNum, [in] BSTR lastNum, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	startNum
	<dd>
		String containing the start invoice number. String is cut to 
		the first 10 characters and is filled with starting zeroes if shorter.
	</dd></dt>
	<dt>
	lastNum
	<dd>
		String containing the last invoice number. String is cut to 
		the first 10 characters and is filled with starting zeroes if shorter.
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetTaxPercentsEU", "SetTaxPercentsEU");</script>
&nbsp;-&nbsp;Setup percents for different VAT classes.
<br>
<div id="SetTaxPercentsEU" class="msgbody">
<pre>
HRESULT SetTaxPercentsEU([in] BSTR password, [in] double tgr1, [in] double tgr2, [in] double tgr3, [in] double tgr4, [in] double tgr5, [in] double tgr6, [in] double tgr7, [in] double tgr8, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	password
	<dd>
		String containing fiscal password. It is cut to the first 6 characters
	</dd></dt>
	<dt>
	tgr1 äî tgr8
	<dd>
		VAT classes percents
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<h3>Remarks:</h3>
<p>It is possible to suppress VAT classes E to H using -1.0 as VAT class percent</p>
<br>
</div>

<script language="JavaScript">mf_text("SetPayTypeEU", "SetPayTypeEU");</script>
&nbsp;-&nbsp;Set pay type name and exchange rate
<br>
<div id="SetPayTypeEU" class="msgbody">
<pre>
HRESULT SetPayTypeEU([in]BYTE type, [in] BSTR line, [in] double exchRate, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	type
	<dd>
		Specify the payment type number (1 to 4)
	</dd></dt>
	<dt>
	line
	<dd>
		String containing payment type name. It is cut to the first 10 characters
	</dd></dt>
	<dt>
	exchRate
	<dd>
		Specify exchange rate
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

<script language="JavaScript">mf_text("SetParametersEU", "SetParametersEU");</script>
&nbsp;-&nbsp;Set different Fiscal Printer parameters
<br>
<div id="SetParametersEU" class="msgbody">
<pre>
SetParametersEU([in] WORD fpnum, [in] BOOL logo, [in] BOOL till, [in] BOOL autocut, [in] BOOL transparent, [in] BOOL shortEJ, [in] BOOL currency, [out, retval] long *pRes);
</pre>
<h3>Parameters:</h3>
<dl>
	<dt>
	fpNum
	<dd>
		Specify the Fiscal Printer place number
	</dd></dt>
	<dt>
	logo
	<dd>
		logo printing status (0 = not printed, otherwise printed)
	</dd></dt>
	<dt>
	till
	<dd>
		till status (0 = don't have a till, otherwise till is present)
	</dd></dt>
	<dt>
	autocut
	<dd>
		auto cutter status (0 = don't have one, otherwise present)
	</dd></dt>
	<dt>
	transparent
	<dd>
		transparent display status (0 = no display or not transparent, otherwise 
		transparent display)
	</dd></dt>
	<dt>
	shortEJ
	<dd>
		Electronic Journal mode (0 = full, 1 = short)
	</dd></dt>
	<dt>
	currency
	<dd>
		use currnecy in receipt (0 = no, 1 = yes)
	</dd></dt>
</dl>
<h3>Return Value:</h3>
<p>ZFPE_SUCCESS on success, otherwise an error code</p>
<br>
</div>

</p>

<p><b>New functions in version 2.5 - 3.0 of the library</b></p>
<p>For detailed description of the parameters see the corresponding methods of <a href="..\..\api\en\members_en.html">CZekaFP</a> class.</p>
<p>
SetLogo  - Set Current Logo<br>
GetLogoInfo  - Reads information for available logos and current logo ID. The result is stored in logo_info buffer<br>
FindFirstFPCOMEx  - Search for Zeka fiscal printer on all COM ports and return the first COM port number with Zeka Fiscal Printer connected<br>
SetLogoFileEx  - Setup logo from bitmap file<br>
PrintLogoEx  - Print logo (0-9)<br>
CloseBonInCash  - Direct receipt completion in cash<br>
PaymentEx  - Register a payment<br>
SellDepartmentEx  - Sell from department<br>
SellFreeEx  - Sells an article<br>
SellDBEx  - Sells an article from the Fiscal Printer internal database<br>
GetArticleInfoEx  - Receive information about selected article from the internal Fiscal Printer database<br>
SetArticleInfo2  - Set information about selected article from the internal FP database. Uses SetArticleInfoEx from CZekaFP class<br>
OfficialSumsEx  - Register an official sum addition or withdraw<br>
ReportDepartments  - Report by departments<br>
GetVersionGS  - Get Fiscal Printer version information<br>
EnableCommGS  - Fiscal Printer communication<br>
SetSpeedGS  - Communication speed of the printer<br>
LoadScaleProtocolGS  - Load Scale Protocol<br><br>
EnableBarcode  - Enable/disable barcode printing after fiscal receipt<br>
FormatBarcode  - Set barcode format<br>
PrintBarcode  - Print barcode directly<br>
SetLineWidth  - Set line width in chars for the FP<br>
SetPrintMode  - Set deferred print mode for fast printing<br>
OpenTillEx  - Open cash drawer<br>
OpenSerialPort  - Open the serial port and keep open until CloseSerialPort call<br>
CloseSerialPort  - Close the serial port<br>
TerminateBon  - This is a compound function. If there is open fiscal or non-fiscal receipt it will be closed.
The purpose of this function is to exit from unexpected errors while there is open receipt
</p>

<p><b>See Also</b>
<br>
<a href="index_en.html">Remarks</a><br>
<br>
Interfaces which are returned as IZekaFP method result<br>
<br>
<a href="IGetCurrentBonInfoRes_en.html">Methods of IGetCurrentBonInfoRes interface</a><br>
<a href="ITaxNumbers_en.html">Methods of ITaxNumbers interface</a><br>
<a href="IPayTypes_en.html">Methods of IPayTypes interface</a><br>
<a href="IZFPParameters_en.html">Methods of IZFPParameters interface</a><br>
<a href="IOperatorInfo_en.html">Methods of IOperatorInfo interface</a><br>
<a href="IArticleInfo_en.html">Methods of IArticleInfo interface</a><br>
<a href="IDailySums_en.html">Methods of IDailySums interface</a><br>
<a href="IFiscalReportData_en.html">Methods of IFiscalReportData interface</a><br>
<a href="IDailyReport_en.html">Methods of IDailyReport interface</a><br>
<a href="IZFPStatus_en.html">Methods of IZFPStatus interface</a><br>
<a href="IInvoiceNumbers_en.html">Methods of IInvoiceNumbers interface</a><br>
</p>
</body>
</html>